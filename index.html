<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>POS App – Kiosk Mode</title>
<style>
  body { margin:0; font-family:Arial, sans-serif; background:#f4f4f4; }
  header { background:#333; color:#fff; padding:10px; display:flex; justify-content:space-between; }
  #items { height:60vh; overflow-y:auto; padding:10px; display:flex; flex-direction:column; gap:10px; }
  .item-btn { padding:15px; font-size:18px; border:none; border-radius:8px; cursor:pointer; color:#fff; }
  #cart { background:#fff; padding:10px; border-top:2px solid #ccc; height:25vh; overflow-y:auto; }
  .cart-item { display:flex; justify-content:space-between; align-items:center; margin:5px 0; }
  .cancel { background:#d33; color:#fff; border:none; padding:5px; margin-right:5px; border-radius:4px; cursor:pointer; }
  #totals { background:#eee; padding:10px; }
  .btn { padding:10px; margin:5px; font-size:16px; border:none; border-radius:5px; cursor:pointer; }
  .cash-btn { background:#0077cc; color:#fff; }
  .pay-btn { background:#28a745; color:#fff; }
  #supervisorOverlay {
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.8); color:#000; display:none; flex-direction:column;
    justify-content:flex-start; align-items:center; padding:20px; overflow:auto;
  }
  #supervisorPanel {
    background:#fff; padding:20px; border-radius:10px; width:90%; max-width:600px;
  }
  input, select { padding:8px; margin:5px 0; width:100%; }
</style>
</head>
<body>

<header>
  <h2>POS App</h2>
  <button onclick="showSupervisor()" class="btn">Supervisor</button>
</header>

<div id="items"></div>

<div id="cart"></div>

<div id="totals">
  <div>Subtotal: <span id="subtotal">0</span></div>
  <div>Total: <span id="total">0</span></div>
  <div>Cash Tendered: <span id="cash">0</span></div>
  <div>Change: <span id="change">0</span></div>
  <button class="cash-btn" onclick="tender(50)">₱50</button>
  <button class="cash-btn" onclick="tender(100)">₱100</button>
  <button class="cash-btn" onclick="tender(200)">₱200</button>
  <button class="cash-btn" onclick="tender(1000)">₱1000</button>
  <button class="pay-btn" onclick="finalizeSale()">Pay</button>
</div>

<!-- Supervisor Panel -->
<div id="supervisorOverlay">
  <div id="supervisorPanel">
    <h2>Supervisor Panel</h2>
    <div id="supervisorLogin">
      <input type="password" id="supPass" placeholder="Enter Supervisor Password">
      <button onclick="loginSupervisor()">Login</button>
      <button onclick="hideSupervisor()">Close</button>
    </div>
    <div id="supervisorContent" style="display:none;">
      <h3>Item Management</h3>
      <input type="text" id="newName" placeholder="Item Name">
      <input type="number" id="newPrice" placeholder="Item Price">
      <input type="color" id="newColor" value="#0077cc">
      <button onclick="addItem()">Add Item</button>
      <h3>Items List</h3>
      <ul id="itemList"></ul>
      <h3>Transaction Logs</h3>
      <pre id="logs"></pre>
      <button onclick="logoutSupervisor()">Logout</button>
    </div>
  </div>
</div>

<script>
let items = JSON.parse(localStorage.getItem("items")) || [
  {name:"Burger", price:50, color:"#d9534f"},
  {name:"Fries", price:30, color:"#f0ad4e"},
  {name:"Soda", price:20, color:"#5bc0de"},
  {name:"Coffee", price:25, color:"#5cb85c"}
];
let cart = [];
let subtotal=0, total=0, cash=0;
let logs = JSON.parse(localStorage.getItem("logs")) || [];
const SUPERVISOR_PASSWORD = "pi123"; // changeable later

function renderItems(){
  const div = document.getElementById("items");
  div.innerHTML="";
  items.forEach((it,i)=>{
    let btn=document.createElement("button");
    btn.className="item-btn";
    btn.style.background=it.color;
    btn.textContent=`${it.name} ₱${it.price}`;
    btn.onclick=()=>addToCart(i);
    div.appendChild(btn);
  });
}

function addToCart(i){
  let found = cart.find(ci=>ci.name===items[i].name);
  if(found){ found.qty++; }
  else{ cart.push({...items[i], qty:1}); }
  updateCart();
}

function updateCart(){
  const div=document.getElementById("cart");
  div.innerHTML="";
  subtotal=0;
  cart.forEach((it,idx)=>{
    subtotal+=it.price*it.qty;
    let row=document.createElement("div");
    row.className="cart-item";
    row.innerHTML=`
      <button class="cancel" onclick="decrease(${idx})">❌</button>
      ${it.name} x${it.qty} = ₱${it.price*it.qty}
    `;
    div.appendChild(row);
  });
  total=subtotal; 
  document.getElementById("subtotal").textContent=subtotal;
  document.getElementById("total").textContent=total;
}

function decrease(idx){
  cart[idx].qty--;
  if(cart[idx].qty<=0) cart.splice(idx,1);
  updateCart();
}

function tender(amount){
  cash+=amount;
  document.getElementById("cash").textContent=cash;
  document.getElementById("change").textContent=cash-total;
}

function finalizeSale(){
  if(cash<total){ alert("Not enough cash!"); return; }
  let transaction={time:new Date().toLocaleString(), cart:[...cart], total, cash, change:cash-total};
  logs.push(transaction);
  localStorage.setItem("logs", JSON.stringify(logs));
  alert("Sale completed! Change: ₱"+(cash-total));
  resetSale();
}

function resetSale(){
  cart=[]; subtotal=0; total=0; cash=0;
  updateCart();
  document.getElementById("cash").textContent=0;
  document.getElementById("change").textContent=0;
}

function showSupervisor(){ document.getElementById("supervisorOverlay").style.display="flex"; }
function hideSupervisor(){ document.getElementById("supervisorOverlay").style.display="none"; }

function loginSupervisor(){
  let pass=document.getElementById("supPass").value;
  if(pass===SUPERVISOR_PASSWORD){
    document.getElementById("supervisorLogin").style.display="none";
    document.getElementById("supervisorContent").style.display="block";
    renderSupervisor();
  } else { alert("Wrong password"); }
}

function logoutSupervisor(){
  document.getElementById("supervisorLogin").style.display="block";
  document.getElementById("supervisorContent").style.display="none";
  document.getElementById("supPass").value="";
  hideSupervisor();
}

function addItem(){
  let name=document.getElementById("newName").value;
  let price=parseFloat(document.getElementById("newPrice").value);
  let color=document.getElementById("newColor").value;
  if(name && price){
    items.push({name,price,color});
    localStorage.setItem("items",JSON.stringify(items));
    renderItems();
    renderSupervisor();
  }
}

function renderSupervisor(){
  const ul=document.getElementById("itemList");
  ul.innerHTML="";
  items.forEach((it,i)=>{
    let li=document.createElement("li");
    li.textContent=`${it.name} - ₱${it.price}`;
    ul.appendChild(li);
  });
  document.getElementById("logs").textContent=JSON.stringify(logs,null,2);
}

renderItems();
updateCart();
</script>
</body>
</html>
