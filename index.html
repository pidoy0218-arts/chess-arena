<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>POS System - Editable Header + Park Sale</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; font-family:Arial, sans-serif; display:flex; height:100vh; }
.cart, .items { padding:10px; box-sizing:border-box; }
.cart { width:50%; background:#f9f9f9; overflow-y:auto; }
.items { width:50%; background:#fff; overflow-y:auto; display:flex; flex-direction:column; max-height:calc(100vh - 100px); }
.item-btn { padding:20px; margin:5px 0; font-size:20px; border:none; border-radius:8px; color:#fff; cursor:pointer; }
.cart-item { display:flex; align-items:center; justify-content:space-between; padding:8px; margin:4px 0; background:#eee; border-radius:6px; }
.cancel-btn, .edit-btn { border:none; border-radius:4px; padding:2px 6px; margin-right:6px; cursor:pointer; font-size:14px; }
.cancel-btn { background:#dc3545; color:#fff; }
.edit-btn { background:#ffc107; color:#000; }
.footer { position:absolute; bottom:0; left:0; width:100%; background:#222; color:#fff; padding:10px; display:flex; flex-wrap:wrap; align-items:center; }
.footer div { margin:5px 10px; font-size:18px; }
.cash-btn { padding:10px 20px; margin:3px; border:none; border-radius:6px; background:#007bff; color:#fff; font-size:16px; cursor:pointer; }
.pay-btn { padding:10px 20px; margin:3px; border:none; border-radius:6px; background:#28a745; color:#fff; font-size:18px; flex:1; }
.cash-input { padding:10px; margin:3px; border-radius:6px; border:1px solid #ccc; font-size:16px; width:120px; }

/* Editable receipt header */
#receiptHeader { text-align:center; font-weight:bold; font-size:18px; padding:10px; border:1px dashed #999; margin-bottom:10px; }
#receiptHeader:focus { outline: 2px solid #007bff; border-style: solid; }

/* Parked sales popup */
#parkPopup {
  display:none; position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.6); z-index:10000; align-items:center; justify-content:center;
}
#parkContent {
  background:#fff; padding:15px; border-radius:8px; width:90%; max-width:400px;
  max-height:80%; overflow-y:auto;
}
.park-entry { display:flex; justify-content:space-between; align-items:center; padding:6px; border-bottom:1px solid #ccc; }
.resume-btn { background:#28a745; color:#fff; border:none; border-radius:4px; padding:4px 8px; cursor:pointer; }
</style>
</head>
<body>

<!-- CASHIER SCREEN -->
<div id="cashier-screen" style="display:flex; width:100%; height:100%;">
  <div class="cart" id="cart">
    <!-- Editable Receipt Header -->
    <div id="receiptHeader" contenteditable="true">
      Store Name<br>
      Address Line<br>
      Contact Info
    </div>
  </div>
  <div class="items" id="items"></div>
</div>

<div class="footer">
  <div id="subtotal">Subtotal: ₱0</div>
  <div id="total">Total: ₱0</div>
  <div id="change">Change: ₱0</div>
  <button class="cash-btn" onclick="cashTender(50)">₱50</button>
  <button class="cash-btn" onclick="cashTender(100)">₱100</button>
  <button class="cash-btn" onclick="cashTender(200)">₱200</button>
  <button class="cash-btn" onclick="cashTender(500)">₱500</button>
  <button class="cash-btn" onclick="cashTender(1000)">₱1000</button>
  <input class="cash-input" type="number" id="customCash" placeholder="Enter ₱" oninput="customCashTender()">
  <button class="pay-btn" onclick="payAndReset()">PAY & RESET</button>
  <button class="cash-btn" onclick="showParked()">Parked Sales</button>
</div>

<!-- Park Sale Popup -->
<div id="parkPopup">
  <div id="parkContent">
    <h3>Parked Sales</h3>
    <div id="parkList"></div>
    <button onclick="closePark()" style="margin-top:10px; padding:6px 12px;">Close</button>
  </div>
</div>

<script>
let cart = [];
let tendered = 0;
let parked = {}; // { customerName: [items] }
let parkCounter = 1;

function renderCart(){
  const cartDiv = document.getElementById("cart");
  const header = document.getElementById("receiptHeader");
  cartDiv.innerHTML = header.outerHTML;
  document.getElementById("receiptHeader").innerHTML = header.innerHTML;

  cart.forEach((item,index)=>{
    let div = document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`
      <button class="edit-btn" onclick="editQty(${index})">✏️</button>
      <button class="cancel-btn" onclick="removeItem(${index})">❌</button>
      <span>${item.name} x${item.qty}</span>
      <span>₱${item.price*item.qty}</span>
    `;
    cartDiv.appendChild(div);
  });

  let subtotal = cart.reduce((sum,i)=>sum+i.price*i.qty,0);
  document.getElementById("subtotal").textContent="Subtotal: ₱"+subtotal;
  document.getElementById("total").textContent="Total: ₱"+subtotal;
  document.getElementById("change").textContent="Change: ₱"+(tendered-subtotal);
}

function cashTender(amount){ tendered+=amount; renderCart(); }
function customCashTender(){ tendered=parseFloat(document.getElementById("customCash").value)||0; renderCart(); }

function removeItem(i){ cart.splice(i,1); renderCart(); }
function editQty(i){
  let newQty = prompt("Enter new qty:", cart[i].qty);
  if(newQty && !isNaN(newQty)){ cart[i].qty = parseInt(newQty); renderCart(); }
}

function payAndReset(){
  if(cart.length===0){ alert("Cart empty"); return; }
  let subtotal = cart.reduce((s,i)=>s+i.price*i.qty,0);
  if(tendered<subtotal){ alert("Insufficient payment"); return; }
  alert("Payment successful! Change: ₱"+(tendered-subtotal));
  cart=[]; tendered=0;
  // clear this customer if loaded from parked
  if(currentCustomer){
    delete parked[currentCustomer];
    currentCustomer=null;
  }
  renderCart(); updateParkList();
}

// --- Park sale handling ---
let currentCustomer=null;

function parkSale(){
  if(cart.length===0){ alert("Nothing to park"); return; }
  let name="Customer"+parkCounter++;
  parked[name]=JSON.parse(JSON.stringify(cart));
  cart=[]; tendered=0; renderCart(); updateParkList();
}

function showParked(){
  document.getElementById("parkPopup").style.display="flex";
  updateParkList();
}
function closePark(){ document.getElementById("parkPopup").style.display="none"; }

function updateParkList(){
  const list=document.getElementById("parkList");
  list.innerHTML="";
  for(let c in parked){
    let div=document.createElement("div");
    div.className="park-entry";
    div.innerHTML=`<span>${c} (${parked[c].length} items)</span>
      <button class="resume-btn" onclick="resumeCart('${c}')">Resume</button>`;
    list.appendChild(div);
  }
}

function resumeCart(cust){
  cart=JSON.parse(JSON.stringify(parked[cust]));
  currentCustomer=cust;
  closePark(); renderCart();
}
</script>
</body>
</html>
