<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>POS System</title>
<style>
  body { margin:0; font-family:Arial, sans-serif; background:#f4f4f4; }
  header { background:#222; color:#fff; padding:10px; text-align:center; }
  #headerText { font-size:18px; font-weight:bold; }
  .container { display:flex; height:calc(100vh - 50px); }
  .items { flex:1; overflow-y:auto; padding:10px; background:#fff; border-right:2px solid #ccc; }
  .item-btn { display:block; width:100%; padding:15px; margin:5px 0; font-size:18px; border:none; color:#fff; border-radius:8px; cursor:pointer; }
  .cart { flex:1; display:flex; flex-direction:column; padding:10px; }
  .cart-list { flex:1; overflow-y:auto; background:#fff; padding:10px; border:1px solid #ccc; margin-bottom:10px; }
  .cart-item { display:flex; justify-content:space-between; margin:5px 0; }
  .cancel-btn { background:red; color:#fff; border:none; padding:2px 6px; cursor:pointer; font-size:14px; margin-right:5px; }
  .totals { background:#fff; padding:10px; border:1px solid #ccc; }
  .btn { padding:10px; margin:5px; font-size:16px; border:none; border-radius:6px; cursor:pointer; }
  .tender-btn { background:#333; color:#fff; }
  #supervisorPanel { position:fixed; top:-100%; left:0; width:100%; height:100%; background:#eee; overflow-y:auto; transition:top 0.3s; padding:20px; z-index:1000; }
  #supervisorPanel.active { top:0; }
  .supervisor-section { margin-bottom:20px; padding:10px; background:#fff; border:1px solid #ccc; }
</style>
</head>
<body>
<header>
  <div id="headerText">My Store POS</div>
</header>
<div class="container">
  <div class="items" id="itemsPanel"></div>
  <div class="cart">
    <div class="cart-list" id="cartList"></div>
    <div class="totals">
      <div>Subtotal: ₱<span id="subtotal">0</span></div>
      <div>Total: ₱<span id="total">0</span></div>
      <button class="btn" onclick="parkSale()">Park Sale</button>
      <button class="btn" onclick="recallSale()">Recall Sale</button>
      <div>
        <button class="btn tender-btn" onclick="tenderCash(50)">₱50</button>
        <button class="btn tender-btn" onclick="tenderCash(100)">₱100</button>
        <button class="btn tender-btn" onclick="tenderCash(200)">₱200</button>
        <button class="btn tender-btn" onclick="tenderCash(1000)">₱1000</button>
        <button class="btn tender-btn" onclick="customTender()">Custom</button>
      </div>
    </div>
  </div>
</div>

<!-- Supervisor Panel -->
<div id="supervisorPanel">
  <h2>Supervisor Mode</h2>
  <button onclick="closeSupervisor()">Close</button>

  <div class="supervisor-section">
    <h3>Edit Receipt Header</h3>
    <input type="text" id="headerInput" placeholder="Enter header text">
    <button onclick="saveHeader()">Save</button>
  </div>

  <div class="supervisor-section">
    <h3>Manage Items</h3>
    <input type="text" id="itemName" placeholder="Item name">
    <input type="number" id="itemPrice" placeholder="Price">
    <input type="color" id="itemColor" value="#333333">
    <button onclick="addItem()">Add Item</button>
    <div id="itemsManager"></div>
  </div>

  <div class="supervisor-section">
    <h3>Transaction Logs</h3>
    <pre id="logs"></pre>
  </div>
</div>

<script>
let items = JSON.parse(localStorage.getItem("items")||"[]");
let cart = [];
let parkedSales = JSON.parse(localStorage.getItem("parkedSales")||"[]");
let logs = JSON.parse(localStorage.getItem("logs")||"[]");

function renderItems(){
  const panel = document.getElementById("itemsPanel");
  panel.innerHTML="";
  items.forEach((it,i)=>{
    let btn=document.createElement("button");
    btn.className="item-btn";
    btn.style.background=it.color;
    btn.innerText=`${it.name} ₱${it.price}`;
    btn.onclick=()=>addToCart(i);
    panel.appendChild(btn);
  });
  document.getElementById("itemsManager").innerHTML=items.map((it,i)=>`<div>${it.name} - ₱${it.price} <button onclick="deleteItem(${i})">Delete</button></div>`).join("");
}
function addToCart(i){
  let found=cart.find(ci=>ci.name===items[i].name);
  if(found) found.qty++;
  else cart.push({...items[i],qty:1});
  renderCart();
}
function renderCart(){
  const list=document.getElementById("cartList");
  list.innerHTML="";
  let subtotal=0;
  cart.forEach((ci,idx)=>{
    subtotal+=ci.price*ci.qty;
    let div=document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`<button class="cancel-btn" onclick="decreaseItem(${idx})">❌</button> ${ci.qty} × ${ci.name} <span>₱${ci.price*ci.qty}</span>`;
    list.appendChild(div);
  });
  document.getElementById("subtotal").innerText=subtotal;
  document.getElementById("total").innerText=subtotal;
}
function decreaseItem(idx){
  if(cart[idx].qty>1) cart[idx].qty--;
  else cart.splice(idx,1);
  renderCart();
}
function tenderCash(amount){
  let total=parseFloat(document.getElementById("total").innerText);
  let change=amount-total;
  alert(`Tendered: ₱${amount}\nTotal: ₱${total}\nChange: ₱${change}`);
  logs.push({time:new Date().toLocaleString(),cart:[...cart],total});
  localStorage.setItem("logs",JSON.stringify(logs));
  cart=[]; renderCart();
}
function customTender(){
  let amt=prompt("Enter cash amount:");
  if(amt) tenderCash(parseFloat(amt));
}
function parkSale(){
  if(cart.length===0) return alert("No items to park.");
  parkedSales.push([...cart]);
  localStorage.setItem("parkedSales",JSON.stringify(parkedSales));
  cart=[]; renderCart(); alert("Sale parked.");
}
function recallSale(){
  if(parkedSales.length===0) return alert("No parked sales.");
  cart=parkedSales.shift();
  localStorage.setItem("parkedSales",JSON.stringify(parkedSales));
  renderCart();
}
function openSupervisor(){
  let pass=prompt("Enter Supervisor Password:");
  if(pass==="1234"){
    document.getElementById("supervisorPanel").classList.add("active");
    renderSupervisor();
  } else alert("Wrong password");
}
function closeSupervisor(){ document.getElementById("supervisorPanel").classList.remove("active"); }
function renderSupervisor(){
  document.getElementById("headerInput").value=document.getElementById("headerText").innerText;
  document.getElementById("logs").innerText=logs.map(l=>`${l.time} - ₱${l.total}`).join("\n");
}
function saveHeader(){
  let text=document.getElementById("headerInput").value;
  document.getElementById("headerText").innerText=text;
  localStorage.setItem("headerText",text);
}
function addItem(){
  let name=document.getElementById("itemName").value;
  let price=parseFloat(document.getElementById("itemPrice").value);
  let color=document.getElementById("itemColor").value;
  if(!name||!price) return;
  items.push({name,price,color});
  localStorage.setItem("items",JSON.stringify(items));
  renderItems();
}
function deleteItem(i){
  items.splice(i,1);
  localStorage.setItem("items",JSON.stringify(items));
  renderItems();
}

// init
renderItems();
if(localStorage.getItem("headerText")) document.getElementById("headerText").innerText=localStorage.getItem("headerText");

// shortcut: press S for Supervisor
document.addEventListener("keydown",e=>{ if(e.key==="S"||e.key==="s") openSupervisor(); });
</script>
</body>
</html>
