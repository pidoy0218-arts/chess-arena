<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>POS with Supervisor & Readings</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f5f5f5;
  }
  .cashier-screen {
    padding: 10px;
  }
  .items-container {
    max-height: 350px; /* Longer scroll */
    overflow-y: auto;
    border: 1px solid #ccc;
    margin-bottom: 10px;
  }
  .item {
    padding: 10px;
    margin: 5px;
    border-radius: 6px;
    cursor: pointer;
  }
  .totals {
    position: sticky;
    bottom: 0;
    background: #fff;
    padding: 10px;
    border-top: 2px solid #ccc;
  }
  .supervisor-screen {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(240,240,240,0.95);
    z-index: 9999;
    padding: 15px;
    flex-direction: column;
    overflow-y: auto;
  }
  .supervisor-screen h2 {
    margin-top: 0;
  }
  .reading {
    margin: 10px 0;
  }
  .reading button {
    font-size: 12px;
    padding: 3px 6px;
    margin-left: 5px;
  }
  .z-history {
    margin-top: 15px;
    padding: 10px;
    border: 1px dashed #aaa;
    background: #fff;
  }
  .z-history-entry {
    margin-bottom: 5px;
    font-size: 14px;
  }
</style>
</head>
<body>

<div class="cashier-screen">
  <h2>Cashier</h2>
  <div>
    <label>Item Name: <input type="text" id="itemName"></label>
    <label>Price: <input type="number" id="itemPrice" step="0.01"></label>
    <label>Color:
      <select id="itemColor">
        <option value="#ffe4e1">Pastel Pink</option>
        <option value="#e0f7fa">Pastel Blue</option>
        <option value="#f1f8e9">Pastel Green</option>
        <option value="#fff3e0">Pastel Orange</option>
        <option value="#f3e5f5">Pastel Purple</option>
        <option value="#fff9c4">Pastel Yellow</option>
      </select>
    </label>
    <label>Text:
      <select id="itemTextColor">
        <option value="black">Black</option>
        <option value="white">White</option>
      </select>
    </label>
    <button onclick="addItem()">Add Item</button>
  </div>
  <div class="items-container" id="itemsContainer"></div>
  <div class="totals">
    <p>Subtotal: ₱<span id="subtotal">0.00</span></p>
    <p>Total: ₱<span id="total">0.00</span></p>
    <button onclick="pay()">Pay</button>
    <button onclick="openSupervisor()">Supervisor</button>
  </div>
</div>

<div class="supervisor-screen" id="supervisorScreen">
  <h2>Supervisor Panel</h2>
  <div class="reading">
    X Reading: ₱<span id="xReading">0.00</span>
    <button onclick="resetX()">Reset X</button>
  </div>
  <div class="reading">
    Z Reading: ₱<span id="zReading">0.00</span>
    <button onclick="resetZ()">Reset Z</button>
  </div>
  <div class="z-history" id="zHistory">
    <strong>Z History:</strong>
  </div>
  <button onclick="closeSupervisor()">Close</button>
</div>

<script>
  let subtotal = 0;
  let total = 0;
  let xReading = 0;
  let zReading = 0;

  function playBlip(frequency=600, duration=100){
    try {
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = "square";
      osc.frequency.value = frequency;
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start();
      setTimeout(() => { osc.stop(); ctx.close(); }, duration);
    } catch(e) {
      console.log("Audio not supported:", e);
    }
  }

  function addItem() {
    const name = document.getElementById("itemName").value || "Item";
    const price = parseFloat(document.getElementById("itemPrice").value) || 0;
    const color = document.getElementById("itemColor").value;
    const textColor = document.getElementById("itemTextColor").value;

    subtotal += price;
    total += price;
    xReading += price;
    zReading += price;

    const itemDiv = document.createElement("div");
    itemDiv.className = "item";
    itemDiv.textContent = `${name} - ₱${price.toFixed(2)}`;
    itemDiv.style.background = color;
    itemDiv.style.color = textColor;
    itemDiv.onclick = () => cancelItem(price, itemDiv);

    document.getElementById("itemsContainer").appendChild(itemDiv);
    updateTotals();
    playBlip(800, 120);
  }

  function cancelItem(price, itemDiv) {
    subtotal -= price;
    total -= price;
    xReading -= price;
    zReading -= price;
    itemDiv.remove();
    updateTotals();
    playBlip(300, 120);
  }

  function pay() {
    subtotal = 0;
    document.getElementById("itemsContainer").innerHTML = "";
    updateTotals();
    playBlip(1000, 200);
  }

  function updateTotals() {
    document.getElementById("subtotal").textContent = subtotal.toFixed(2);
    document.getElementById("total").textContent = total.toFixed(2);
    document.getElementById("xReading").textContent = xReading.toFixed(2);
    document.getElementById("zReading").textContent = zReading.toFixed(2);
  }

  function openSupervisor() {
    document.getElementById("supervisorScreen").style.display = "flex";
  }
  function closeSupervisor() {
    document.getElementById("supervisorScreen").style.display = "none";
  }

  function resetX() {
    xReading = 0;
    updateTotals();
    playBlip(500, 150);
  }

  function resetZ() {
    const zHistDiv = document.getElementById("zHistory");
    const timestamp = new Date().toLocaleString();
    const entry = document.createElement("div");
    entry.className = "z-history-entry";
    entry.textContent = `${timestamp} — Z Reset: ₱${zReading.toFixed(2)}`;
    zHistDiv.appendChild(entry);

    zReading = 0;
    xReading = 0;
    updateTotals();
    playBlip(200, 200);
  }
</script>

</body>
</html>
